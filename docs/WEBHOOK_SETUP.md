# GitHub Webhook Setup - Complete Guide

## âœ… Current Status

Your webhook is **functionally implemented** but environment configuration needs fixing.

## ğŸ”§ Issue Found

The Pydantic Settings configuration is now reading `.env` but having trouble parsing `CORS_ORIGINS`.

## ğŸ“ Solution

### Step 1: Fix your `.env` file

Make sure your `backend/.env` contains:

```env
# GitHub Webhook (REQUIRED for security)
GITHUB_WEBHOOK_SECRET=my_super_secret_webhook_key_2025

# CORS - Use JSON array format for Pydantic
CORS_ORIGINS=["http://localhost:3000"]
```

**OR** if you want multiple origins:
```env
CORS_ORIGINS=["http://localhost:3000","http://localhost:8000"]
```

### Step 2: Restart the Server

```bash
# Stop current server (Ctrl+C)
# Then start fresh:
python -m uvicorn app.main:app --reload
```

### Step 3: Test

Run this to verify the webhook secret is loaded:
```bash
python check_config.py
```

You should see:
```
âœ… Webhook secret is loaded: my_super_s...
```

### Step 4: Test Webhook Security

```bash
python test_webhook_sig.py
```

Expected output:
```
âœ… PASS - Valid signature accepted
âœ… PASS - Invalid signature rejected with 401
```

## ğŸŒ Testing with Real GitHub Webhooks

Once the config is working:

1. **Expose your local server:**
   ```bash
   ngrok http 8000
   ```

2. **Configure GitHub:**
   - Go to your repo â†’ Settings â†’ Webhooks
   - Add webhook:
     - URL: `https://your-ngrok-url.ngrok.io/api/webhooks/github`
     - Secret: `my_super_secret_webhook_key_2025`
     - Content type: `application/json`
     - Events: Just the push event

3. **Test:**
   - Push code to your repo
   - Watch your server logs
   - Check GitHub's webhook delivery page

## ğŸ¯ What the Webhook Does

When you push code to GitHub:
1. GitHub sends a signed webhook to your server
2. Server verifies the HMAC signature
3. If valid, triggers an automatic repository scan
4. Updated documentation is generated by Gemini AI
5. Results saved to database

Your platform will automatically stay in sync with your code! ğŸš€
